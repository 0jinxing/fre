{"version":3,"file":"fre-compat.js","sources":["../index.js"],"sourcesContent":["import { jsx, useState, useEffect, options } from 'fre'\r\n\r\nlet oldCatchError = options.catchError\r\noptions.catchError = (fiber, error) => {\r\n  if (!!error && typeof error.then === 'function') {\r\n    fiber.promises = fiber.promises || []\r\n    fiber.promises.push(error)\r\n    oldCatchError(fiber, error)\r\n  }\r\n}\r\n\r\nexport function lazy(loader) {\r\n  let p\r\n  let comp\r\n  let err\r\n  return function Lazy(props) {\r\n    if (!p) {\r\n      p = loader()\r\n      p.then(\r\n        exports => (comp = exports.default || exports),\r\n        e => (err = e)\r\n      )\r\n    }\r\n    if (err) throw err\r\n    if (!comp) throw p\r\n    return jsx(comp, props)\r\n  }\r\n}\r\n\r\nexport function Suspense(props) {\r\n  const [suspend, setSuspend] = useState(false)\r\n  useEffect(current => {\r\n    Promise.all(current.promises).then(() => setSuspend(true))\r\n  }, [])\r\n  return [props.children, !suspend && props.fallback]\r\n}\r\n"],"names":["options","jsx","useState","useEffect"],"mappings":";;;;;;EAEA,IAAI,aAAa,GAAGA,WAAO,CAAC,WAAU;AACtCA,aAAO,CAAC,UAAU,GAAG,CAAC,KAAK,EAAE,KAAK,KAAK;EACvC,EAAE,IAAI,CAAC,CAAC,KAAK,IAAI,OAAO,KAAK,CAAC,IAAI,KAAK,UAAU,EAAE;EACnD,IAAI,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,IAAI,GAAE;EACzC,IAAI,KAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,EAAC;EAC9B,IAAI,aAAa,CAAC,KAAK,EAAE,KAAK,EAAC;EAC/B,GAAG;EACH,EAAC;AACD;EACO,SAAS,IAAI,CAAC,MAAM,EAAE;EAC7B,EAAE,IAAI,EAAC;EACP,EAAE,IAAI,KAAI;EACV,EAAE,IAAI,IAAG;EACT,EAAE,OAAO,SAAS,IAAI,CAAC,KAAK,EAAE;EAC9B,IAAI,IAAI,CAAC,CAAC,EAAE;EACZ,MAAM,CAAC,GAAG,MAAM,GAAE;EAClB,MAAM,CAAC,CAAC,IAAI;EACZ,QAAQ,OAAO,KAAK,IAAI,GAAG,OAAO,CAAC,OAAO,IAAI,OAAO,CAAC;EACtD,QAAQ,CAAC,KAAK,GAAG,GAAG,CAAC,CAAC;EACtB,QAAO;EACP,KAAK;EACL,IAAI,IAAI,GAAG,EAAE,MAAM,GAAG;EACtB,IAAI,IAAI,CAAC,IAAI,EAAE,MAAM,CAAC;EACtB,IAAI,OAAOC,OAAG,CAAC,IAAI,EAAE,KAAK,CAAC;EAC3B,GAAG;EACH,CAAC;AACD;EACO,SAAS,QAAQ,CAAC,KAAK,EAAE;EAChC,EAAE,MAAM,CAAC,OAAO,EAAE,UAAU,CAAC,GAAGC,YAAQ,CAAC,KAAK,EAAC;EAC/C,EAAEC,aAAS,CAAC,OAAO,IAAI;EACvB,IAAI,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,MAAM,UAAU,CAAC,IAAI,CAAC,EAAC;EAC9D,GAAG,EAAE,EAAE,EAAC;EACR,EAAE,OAAO,CAAC,KAAK,CAAC,QAAQ,EAAE,CAAC,OAAO,IAAI,KAAK,CAAC,QAAQ,CAAC;EACrD;;;;;;;;;;;;;"}